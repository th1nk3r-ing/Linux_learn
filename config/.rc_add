# ubuntu's bash & zsh persional configeriation
# @think3r 2020-07-01 00:06:07

# print color alias
if (uname -a | grep "Linux" > /dev/null) ; then # gnu-linux
    export prt_Green="\e[1;32m"
    export prt_Yellow="\e[1;33m"
    export prt_Red="\e[1;31m"
    export prt_RedLine="\e[4;31m"
    export prt_GreenLine="\e[4;32m"
    export prt_YellowLine="\e[4;33m"
    export prt_End="\e[0m"
elif (uname -a | grep "Darwin" > /dev/null) ;then #  MACOS 下的颜色输出不太一样;
    export prt_Green="\033[1;32m"
    export prt_Yellow="\033[1;33m"
    export prt_Red="\033[1;31m"
    export prt_RedLine="\033[4;31m"
    export prt_GreenLine="\033[4;32m"
    export prt_YellowLine="\033[4;33m"
    export prt_End="\033[0m"
fi

alias ll="ls -alhF --time-style='+%Y/%m/%d_%H:%M:%S'"
alias la='ls -A'
alias l='ls -CF'
alias clc='clear'

# if is WSL / MACOS, add some platform-unique-alias
if (uname -a | grep "Microsoft" >/dev/null) ;then      # WSL
    alias e.='explorer.exe .'

    # 挂载网络磁盘
    # sudo mount -t drvfs D: /mnt/d
    # 自动挂载网络磁盘
    #if [ ! -f "/mnt/u/.bashrc" ]; then
    #	echo passwd | sudo -S mount -t drvfs U: /mnt/u
    #	echo -e $prt_Green "mount netdisk U success!" $prt_End
    #fi

    #取消windows路径中的文件夹背景色
    if [ -f ~/.dir_colors ]; then
        eval "$(dircolors "$HOME/.dir_colors")"
    fi
elif (uname -a | grep "Darwin" >/dev/null) ;then       # MACOS
    alias e.='open .'
    alias ll="ls -alhFGT"   # MACOS ll 特殊化;
    #echo "this is $prt_YellowLine macos $prt_End, reg open ."
fi

# some more ls aliases
if command -v exa > /dev/null; then
	alias el="exa -aHlFg --time-style=long-iso"
fi

# add android-termux command;
if [ -f ~/termux_sh.sh ]; then
    . ~/termux_sh.sh
fi

#autojump
if [ -d "$HOME/.autojump" ]; then
    [[ -s "$HOME/.autojump/etc/profile.d/autojump.sh" ]] && source "$HOME/.autojump/etc/profile.d/autojump.sh"
fi

# 函数: 使用命令得到 git 项目的分支名字;
function parse_git_branch_and_add_brackets {
    git branch --no-color 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/\ \[\1\]/'
}

# PS1 相关
if [ "$SHELL" = "/bin/bash" ]; then
    echo -e "current shell is $prt_Yellow bash $prt_End"
    #设置ssh连接时的shell配色方案为 ubuntu 自带(加入了显示 git 分支的功能;)
    #PS1="\h:\W \u\[\033[0;32m\]\$(parse_git_branch_and_add_brackets) \[\033[0m\]\$ "
    #PS1="${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\$(parse_git_branch_and_add_brackets) \[\033[0m\]\$ "
    PS1="${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\[\033[0;32m\]\$(parse_git_branch_and_add_brackets)\[\033[0m\]\$ "
elif [ "$SHELL" = "/bin/zsh" ]; then
    # oh-my-zsh 默认主题的情况下, 修改 PS1
    if [ -d "$HOME/.oh-my-zsh" ] && [ "$ZSH_THEME" = "robbyrussell" ]; then
        PROMPT='%{$fg_bold[red]%}-> %{$fg_bold[green]%}%p%{$fg[cyan]%}%~ %{$fg_bold[blue]%}$(git_prompt_info)%{$fg_bold[blue]%}% %{$fg[magenta]%}%(?..%?%2v)%{$reset_color%}#: '
    fi
fi

if [ "$SHELL" = "/bin/zsh" ]; then
    # oh-my-zsh 的自动补全插件
    #if [ -d "$HOME/.oh-my-zsh/plugins/incr" ]; then
    #    source "$HOME/.oh-my-zsh/plugins/incr/incr*.zsh"
    #    #echo -e "have is $prt_Red incr file $prt_End"
    #fi

    echo -e "current shell is $prt_Yellow zsh $prt_End"
fi

# 本地的可执行文件 path 添加;
if [ -d "$HOME/bin" ]; then
    # add adb path; 如果不加入, 则需要使用 adb.exe 代替 adb
    my_adb_path="$HOME/bin/platform-tools"
    if [ -d "$my_adb_path" ]; then
       PATH="$PATH:$my_adb_path"
    fi
fi
